<div class="content-wrapper p-0">
  <div class="content-body">
    <section class="users-list-wrapper">
      <div class="card shadow-sm">

        <!-- Header -->
        <div class="card-header d-flex justify-content-between align-items-center">
          <h4 class="mb-0" style="color:#2E5F73; font-weight:600;">
            GST Details by Transaction
          </h4>

          <div class="d-flex align-items-center">
            <button class="btn btn-outline-secondary btn-sm mr-50"
                    (click)="exportToPdf()"
                    [disabled]="!rows?.length">
              <i class="far fa-file-pdf mr-25"></i> PDF
            </button>
            <button class="btn btn-outline-secondary btn-sm"
                    (click)="exportToExcel()"
                    [disabled]="!rows?.length">
              <i class="far fa-file-excel mr-25"></i> Excel
            </button>
          </div>
        </div>

        <div class="card-body">

          <!-- Filters row -->
          <div class="row mb-2 align-items-end">

            <!-- From Date -->
            <div class="col-md-3 col-sm-6 mb-1">
              <label class="form-label small mb-25">From Date</label>
              <input type="date"
                     class="form-control form-control-sm"
                     [(ngModel)]="startDate">
            </div>

            <!-- To Date -->
            <div class="col-md-3 col-sm-6 mb-1">
              <label class="form-label small mb-25">To Date</label>
              <input type="date"
                     class="form-control form-control-sm"
                     [(ngModel)]="endDate">
            </div>

            <!-- Type -->
            <div class="col-md-2 col-sm-6 mb-1">
              <label class="form-label small mb-25">Type</label>
              <select class="form-control form-control-sm" [(ngModel)]="docType">
                <option value="ALL">All</option>
                <option value="SI">Sales (Output)</option>
                <option value="PIN">Supplier (Input)</option>
              </select>
            </div>

            <!-- Search -->
            <div class="col-md-2 col-sm-6 mb-1">
              <label class="form-label small mb-25">Search</label>
              <input type="text"
                     class="form-control form-control-sm"
                     placeholder="Doc / Customer / Supplier"
                     [(ngModel)]="searchText">
            </div>

            <!-- Buttons -->
            <div class="col-md-2 col-sm-12 mb-1 d-flex">
              <button class="btn btn-brand btn-sm mr-50 flex-fill"
                      style="background-color:#2E5F73; border-color:#2E5F73;color:white;"
                      (click)="loadDetails()">
                <i class="fas fa-search mr-25"></i> Filter
              </button>
              <button class="btn btn-outline-secondary btn-sm flex-fill"
                      (click)="resetFilters()">
                Reset
              </button>
            </div>
          </div>

          <!-- Totals -->
          <div class="row mb-1" *ngIf="rows?.length">
            <div class="col-md-4 col-sm-6 mb-1">
              <div class="border rounded p-50 bg-light">
                <div class="small text-muted">Total Taxable</div>
                <div class="h6 mb-0">{{ totalTaxable | number:'1.2-2' }}</div>
              </div>
            </div>
            <div class="col-md-4 col-sm-6 mb-1">
              <div class="border rounded p-50 bg-light">
                <div class="small text-muted">Total Tax</div>
                <div class="h6 mb-0">{{ totalTax | number:'1.2-2' }}</div>
              </div>
            </div>
            <div class="col-md-4 col-sm-6 mb-1">
              <div class="border rounded p-50 bg-light">
                <div class="small text-muted">Total Net</div>
                <div class="h6 mb-0">{{ totalNet | number:'1.2-2' }}</div>
              </div>
            </div>
          </div>
<div class="d-flex flex-column flex-md-row 
              justify-content-between align-items-center
              mt-1 w-100 gst-pagination">

    <div class="d-flex flex-wrap align-items-center mb-1 mb-md-0">

      <span class="small mr-50">Show</span>

      <select class="form-control form-control-sm"
              style="width: 90px;"
              [(ngModel)]="pageSize"
              (ngModelChange)="onPageSizeChange($event)">
        <option *ngFor="let opt of pageSizeOptions" [ngValue]="opt">
          {{ opt }}
        </option>
      </select>

      <span class="small ml-50">entries</span>

      <!-- <span class="small mx-50">·</span>

      <span class="small text-muted">
        Showing
        <strong>{{ displayFrom }}</strong>
        –
        <strong>{{ displayTo }}</strong>
        of <strong>{{ totalRows }}</strong> entries
      </span> -->

    </div>

   
  </div>
          <!-- Table -->
          <div class="table-responsive gst-table-wrapper" *ngIf="!isLoading; else loadingTpl">
            <table class="table table-hover align-middle mb-0 gst-table">

              <thead>
                <tr>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;">Type</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;">Source</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;">Date</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;">Doc No</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;">Customer / Supplier</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;" class="text-right">Taxable</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;" class="text-right">Tax</th>
                  <th class="text-nowrap" style="background-color:#2E5F73;color:white;" class="text-right">Net</th>
                </tr>
              </thead>
              <tbody>
                <!-- use pagedRows instead of rows -->
                <tr *ngFor="let r of pagedRows">
                  <td>
                    <span class="badge badge-pill"
                          [ngClass]="r.docType === 'SI' ? 'badge-primary' : 'badge-info'">
                      {{ r.docType === 'SI' ? 'Sales' : 'Supplier' }}
                    </span>
                  </td>
                  <td class="text-nowrap">{{ r.source }}</td>
                  <td class="text-nowrap">{{ r.docDate | date:'dd-MMM-yyyy' }}</td>
                  <td class="text-nowrap">{{ r.docNo }}</td>
                  <td class="text-nowrap">{{ r.partyName }}</td>
                  <td class="text-nowrap">{{ r.taxableAmount | number:'1.2-2' }}</td>
                  <td class="text-nowrap">{{ r.taxAmount | number:'1.2-2' }}</td>
                  <td class="text-nowrap">{{ r.netAmount | number:'1.2-2' }}</td>
                </tr>
                <tr *ngIf="!rows?.length">
                  <td colspan="8" class="text-center text-muted small py-2">
                    No GST transactions found for selected criteria.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <ng-template #loadingTpl>
            <div class="text-center p-2">
              Loading GST details…
            </div>
          </ng-template>

          <!-- Pagination footer -->
      <!-- Pagination footer -->
<div class="d-flex flex-column flex-md-row 
              justify-content-between align-items-center
              mt-1 w-100 gst-pagination">

    <div class="d-flex flex-wrap align-items-center mb-1 mb-md-0">

      <!-- <span class="small mr-50">Show</span>

      <select class="form-control form-control-sm"
              style="width: 90px;"
              [(ngModel)]="pageSize"
              (ngModelChange)="onPageSizeChange($event)">
        <option *ngFor="let opt of pageSizeOptions" [ngValue]="opt">
          {{ opt }}
        </option>
      </select> 

      <span class="small ml-50">entries</span>

      <span class="small mx-50">·</span>-->

      <span class="small text-muted">
        Showing
        <strong>{{ displayFrom }}</strong>
        –
        <strong>{{ displayTo }}</strong>
        of <strong>{{ totalRows }}</strong> entries
      </span>

    </div>

    <ul class="pagination pagination-sm mb-0">
      <li class="page-item" [class.disabled]="page === 1">
        <a class="page-link" href="#" (click)="prevPage()">‹</a>
      </li>

      <li class="page-item"
          *ngFor="let p of pages"
          [class.active]="page === p">
        <a class="page-link" href="#" (click)="goToPage(p)">
          {{ p }}
        </a>
      </li>

      <li class="page-item" [class.disabled]="page === totalPages">
        <a class="page-link" href="#" (click)="nextPage()">›</a>
      </li>
    </ul>
  </div>


        </div>
      </div>
    </section>
  </div>
</div>
